"use strict";const searchInput=document.querySelector(".js-input"),searchBtn=document.querySelector(".js-searchBtn"),serieList=document.querySelector(".js-serieList"),mainContainer=document.querySelector(".js-main"),seriesFavlist=document.querySelector(".js-favAnime");let noList,searchResults;function searchSerie(){void 0!==noList&&(noList.innerHTML="",noList.classList.remove("notFound")),fetch("https://api.jikan.moe/v3/search/anime?q="+searchInput.value).then(e=>e.json()).then(e=>{if(e.results.length>0)searchResults=e.results,paintSeries(searchResults);else{noList=document.createElement("p"),noList.classList.add("notFound");const e=document.createTextNode("No tenemos la serie que buscas, prueba otra 🙈");noList.appendChild(e),mainContainer.appendChild(noList)}})}function paintSeries(e){serieList.innerHTML="",null===e&&(e=[]);for(const t of e){const e=document.createElement("li"),s=document.createElement("div");e.setAttribute("data-mal_id",t.mal_id),e.setAttribute("data-title",t.title),e.setAttribute("data-image_url",t.image_url),e.setAttribute("data-synopsis",t.synopsis);const a=document.createTextNode(t.title);s.appendChild(a),s.classList.add("divText"),"https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620"===t.image_url?e.style.backgroundImage=`url(https://via.placeholder.com/300x400/f96457/ffffff/?text=${t.title})`:e.style.backgroundImage=`url(${t.image_url})`,serieList.appendChild(e),e.appendChild(s),e.classList.add("listEl");for(const s of arrAnimes)parseInt(s.mal_id)===t.mal_id&&e.classList.add("favStyle");e.addEventListener("click",addFav)}}searchBtn.addEventListener("click",searchSerie);let arrAnimes=JSON.parse(localStorage.getItem("favAnimes"));function addFav(e){arrAnimes.includes(e.currentTarget.dataset)||(arrAnimes.push(e.currentTarget.dataset),localStorage.setItem("favAnimes",JSON.stringify(arrAnimes)),e.currentTarget.classList.add("favStyle"),paintFavseries(arrAnimes))}function paintFavseries(e){seriesFavlist.innerHTML="";for(const t of e){const e=document.createElement("li"),s=document.createElement("button"),a=document.createTextNode("❌"),i=document.createElement("div"),n=document.createElement("img");n.classList.add("listImg");const r=document.createTextNode(t.title),c=document.createTextNode(t.synopsis);"https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620"===t.image_url?n.setAttribute("src","https://via.placeholder.com/300x400/f96457/ffffff/?text="+t.title):n.setAttribute("src",t.image_url),seriesFavlist.appendChild(i),i.appendChild(e),e.appendChild(r),e.appendChild(c),e.appendChild(n),e.appendChild(s),s.appendChild(a),e.classList.add("listFavel"),i.classList.add("divFav"),s.classList.add("deleteFav"),s.setAttribute("data-mal_id",t.mal_id),s.addEventListener("click",deleteFavourite)}}null===arrAnimes&&(arrAnimes=[]),paintFavseries(arrAnimes);const resetFav=document.querySelector(".js-resetFav"),resetBtn=document.querySelector(".js-resetBtn");function resetSearchseries(){location.reload()}function resetFavseries(){localStorage.setItem("favAnimes","[]"),arrAnimes=[],seriesFavlist.innerHTML=""}function deleteFavourite(e){const t=arrAnimes.findIndex(t=>e.currentTarget.dataset.mal_id===t.mal_id);arrAnimes.splice(t,1),localStorage.setItem("favAnimes",JSON.stringify(arrAnimes)),paintFavseries(arrAnimes),paintSeries(searchResults)}resetBtn.addEventListener("click",resetSearchseries),resetFav.addEventListener("click",resetFavseries);